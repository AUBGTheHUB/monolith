#!/bin/bash

open_file=$(cat $PWD/files_for_commit.txt)

green='\033[0;32m'
blue='\033[0;34m'
end='\033[0m'
red='\033[0;31m'

echo -e "${blue}COMMIT ?= ${open_file}${end}"

if [[ $open_file == "NO PRECOMMIT" ]]
then
    echo "${red}SKIP PRE_COMMIT${end}"
    echo "" > $PWD/files_for_commit.txt
    exit 0
fi



echo -e "${green}Running pre-commit linting${end}"

committedFiles=$(git diff --name-only --cached)
files=$(echo $committedFiles | tr ";" "\\n")

make lint

echo -e "${green}Fixed all issues automatically. Committing..! :)${end}"

echo $files > "files_for_commit.txt"

exit 0


